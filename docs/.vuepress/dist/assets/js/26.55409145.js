(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{417:function(t,a,s){"use strict";s.r(a);var e=s(15),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"让我们来手动配置一台服务器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#让我们来手动配置一台服务器"}},[t._v("#")]),t._v(" 让我们来手动配置一台服务器")]),t._v(" "),s("p",[t._v("当我们从云服务商购买了一台服务器或者确实有一台服务器在手里时，我们需要对它进行一些最基本的配置来使它可以正常工作。这篇文章可以让你了解到如何对一台 Linux 服务器进行基本的配置。"),s("br"),t._v("\n当然，某些云服务商也提供了现成的镜像服务一键搭建及配置。可以根据需求自行选择。")]),t._v(" "),s("h2",{attrs:{id:"step-0-概要"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#step-0-概要"}},[t._v("#")]),t._v(" Step 0. 概要")]),t._v(" "),s("p",[t._v("这篇文章记录使用 CentOS 系统配置一个可以让 Java Web 应用程序工作的服务器。将包含：")]),t._v(" "),s("ul",[s("li",[t._v("基本软件安装及配置")]),t._v(" "),s("li",[t._v("基础配置")]),t._v(" "),s("li",[t._v("Java Web 应用相关软件安装及配置")])]),t._v(" "),s("p",[s("strong",[t._v("在此之前你需要掌握的知识：")]),t._v("  Linux 基本操作命令")]),t._v(" "),s("p",[s("strong",[t._v("在操作中会使用到的软件：")]),t._v(" Cmder；FileZilla"),s("br"),t._v("\nCmder 用来敲命令，当然你也可以用 PowerShell；"),s("br"),t._v("\nFileZilla 用来通过 FTP 向服务器端操作文件。")]),t._v(" "),s("h2",{attrs:{id:"step-1-配置-ssh-密钥及安全组"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#step-1-配置-ssh-密钥及安全组"}},[t._v("#")]),t._v(" Step 1. 配置 SSH 密钥及安全组")]),t._v(" "),s("p",[t._v("使用 SSH 连接服务器可以让我们免去每次输入密码的麻烦。安全组的配置可以在云服务商端设置对某端口某协议放行与否，以此来提高安全性。本段所有命令在本机执行。")]),t._v(" "),s("h3",{attrs:{id:"ssh-密钥"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ssh-密钥"}},[t._v("#")]),t._v(" SSH 密钥")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("Vultr 服务器")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("生成 SSH Key"),s("br"),t._v("\n使用命令：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("ssh-keygen\n")])])]),s("p",[t._v("命令会要求进行简单配置，若使用默认配置只需连续按下回车以确认。"),s("br"),t._v("\nSSH Key 会默认存放于 "),s("code",[t._v("C:\\Users\\用户名\\.ssh")]),t._v("（Windows) ；"),s("code",[t._v("~/.ssh/")]),t._v("(Unix)文件夹中。 其中密钥为 "),s("code",[t._v("id_rsa")]),t._v("；公钥为 "),s("code",[t._v("id_rsa.pub")]),t._v("。")])]),t._v(" "),s("li",[s("p",[t._v("部署 SSH Key"),s("br"),t._v("\n使用命令查看公钥：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("cat")]),t._v(" /home/example_user/.ssh/id_rsa.pub\n")])])]),s("p",[t._v("复制弹出的结果，打开 Vultr 网站中 Account> SSH Keys> Add SSH Key 填写表单并保存。"),s("br"),t._v(" "),s("img",{attrs:{src:"/img/vultr_add_ssh_key.jpg",alt:"Add SSH Key"}})])]),t._v(" "),s("li",[s("p",[t._v("使用 SSH Key 部署服务器"),s("br"),t._v("\n在 Vultr 网站中 Products>Deploy New Instance 选择所需要的服务器配置、镜像并勾选刚才配置的 SSH Key.")]),t._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),s("p",[t._v("在 Vultr 中，自动给服务器实例配置 SSH Key 只发生在购买服务器时。所以如果我们已经拥有了一台服务器后意欲自动配置 SSH Key 只能通过重装 SSH Key 操作来实现。而"),s("strong",[t._v("这个操作会抹除服务器的所有内容")]),t._v("。"),s("br"),t._v("\n方法：Vultr 网站中 Products> Server> Settings> Reinstall SSH Keys")]),t._v(" "),s("p",[s("strong",[t._v("手动向服务器部署 SSH Key")]),s("br"),t._v("\n除了 Vultr 提供的自动部署 SSH Key，我们还可以手动向服务器上传 SSH Key来避免抹除已有服务器的麻烦。")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("Windows"),s("br"),t._v(" "),s("strong",[t._v("在 PowerShell 中使用命令：")])]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("type")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$env")]),t._v(":USERPROFILE"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(".ssh"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("id_rsa.pub "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ssh")]),t._v(" root@你的服务器IP "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cat >> .ssh/authorized_keys"')]),t._v("\n")])])]),s("p",[t._v("*"),s("em",[t._v("此操作不能使用 Cmder.")])])]),t._v(" "),s("li",[s("p",[t._v("Linux/macOS"),s("br"),t._v("\n使用命令：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("ssh-copy-id -i ~/.ssh/id_rsa.pub root@你的服务器IP\n")])])]),s("p",[t._v("根据提示要求输入密码来安装 Key.")])])])])]),t._v(" "),s("li",[s("p",[t._v("使用 SSH 登录服务器"),s("br"),t._v("\n使用命令：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ssh")]),t._v(" root@你的服务器IP\n")])])]),s("p",[t._v("即可免密码登录远程服务器。")])])])]),t._v(" "),s("li",[s("p",[t._v("阿里云服务器")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("创建密钥对"),s("br"),t._v("\n在阿里云 ECS 管理控制台中点击 网络与安全> 密钥对。完成相应的配置，点击确定生成密钥对。下载私钥 "),s("code",[t._v("密钥对名称.pem")]),t._v(" 到本地，存放于"),s("code",[t._v("C:\\Users\\用户名\\.ssh")]),t._v("/"),s("code",[t._v("~/.ssh/")]),t._v("下。")])]),t._v(" "),s("li",[s("p",[t._v("绑定密钥对"),s("br"),t._v("\n在密钥对设置中点击：操作> 绑定密钥对。选择要配置的服务器实例，点击确定。（当服务器实例正在运行中时需要对其重新启动）")])]),t._v(" "),s("li",[s("p",[t._v("使用 SSH 连接服务器")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("确认私钥所在位置，并修改其权限。"),s("br"),t._v("\n使用命令：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("chmod")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("400")]),t._v(" ~/.ssh/密钥对名称.pem\n")])])])]),t._v(" "),s("li",[s("p",[t._v("连接服务器实例"),s("br"),t._v("\n使用命令：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ssh")]),t._v(" -i ~/.ssh/密钥对名称.pem root@你的服务器IP\n")])])])])])])])])]),t._v(" "),s("h3",{attrs:{id:"安全组"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安全组"}},[t._v("#")]),t._v(" 安全组")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("Vultr 服务器")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("新建安全组"),s("br"),t._v("\nVultr 网站 Products> Firewall> Add FireWall Group"),s("br"),t._v("\n按提示填写表单。开放端口"),s("code",[t._v("22")]),t._v(", "),s("code",[t._v("80")]),t._v(", "),s("code",[t._v("443")]),t._v(", "),s("code",[t._v("3306")]),t._v(", "),s("code",[t._v("8080")]),t._v(", "),s("code",[t._v("8081")]),t._v(", "),s("code",[t._v("8082")]),t._v("并保存。")])]),t._v(" "),s("li",[s("p",[t._v("绑定安全组"),s("br"),t._v("\nVultr 网站 Products> Server> Settings> Firewall"),s("br"),t._v("\n选择刚才配置的安全组并使其生效。")])])])]),t._v(" "),s("li",[s("p",[t._v("阿里云服务器")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("创建安全组"),s("br"),t._v("\n在 ECS 控制台点击 网络与安全> 安全组> 创建安全组"),s("br"),t._v("\n配置安全组开放端口"),s("code",[t._v("22")]),t._v(", "),s("code",[t._v("80")]),t._v(", "),s("code",[t._v("443")]),t._v(", "),s("code",[t._v("3306")]),t._v(", "),s("code",[t._v("8080")]),t._v(", "),s("code",[t._v("8081")]),t._v(", "),s("code",[t._v("8082")]),t._v("并保存。")])]),t._v(" "),s("li",[s("p",[t._v("绑定安全组"),s("br"),t._v("\n在 ECS 控制台点击 实例与镜像> 实例> 操作> 管理> 本实例安全组> 加入安全组"),s("br"),t._v("\n选择配置的安全组并使其生效。")])])])])]),t._v(" "),s("h2",{attrs:{id:"step-2-安装-vim"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#step-2-安装-vim"}},[t._v("#")]),t._v(" Step 2. 安装 Vim")]),t._v(" "),s("p",[t._v("Vim 是一款基于 Vi 的编辑器。相对于 Vi，它有更强大的功能。我们会使用 Vim 来应对后续编辑文件的需要。"),s("br"),t._v("\n使用 "),s("code",[t._v("yum")]),t._v(" 来安装 vim：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("yum -y "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" vim*\n")])])]),s("p",[t._v("安装完成后，就可以使用 vim 来创建、编辑文件了。这里附上一个简单的"),s("a",{attrs:{href:"https://www.runoob.com/linux/linux-vim.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("教程"),s("OutboundLink")],1),t._v("。")]),t._v(" "),s("h2",{attrs:{id:"step-2-5-配置-swap-可选"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#step-2-5-配置-swap-可选"}},[t._v("#")]),t._v(" Step 2.5. 配置 SWAP（可选）")]),t._v(" "),s("p",[t._v("当服务器内存过小时，会造成某些程序崩溃。增加交换区来配置虚拟内存。")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("SWAP 分区大小"),s("br"),t._v("\n根据红帽建议 "),s("a",{attrs:{href:"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html/installation_guide/s2-diskpartrecommend-ppc#id4394007",target:"_blank",rel:"noopener noreferrer"}},[t._v("Recommended Partitioning Scheme"),s("OutboundLink")],1),t._v("：")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"center"}},[t._v("物理内存")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("建议的交换空间大小")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("若开启休眠功能建议的交换空间大小")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("⩽ 2GB")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("2 倍于 RAM 大小")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("3 倍于 RAM大小")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("> 2GB – 8GB")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("和 RAM 大小相等")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("2 倍于 RAM 大小")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("> 8GB – 64GB")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("至少 4 GB")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("1.5 倍于 RAM 大小")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v(">64GB")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("至少 4 GB")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("不建议休眠")])])])])]),t._v(" "),s("li",[s("p",[t._v("设置 SWAP 分区\n使用命令：")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("创建 SWAP 分区")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("dd")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("if")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/dev/zero "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("of")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/swapfile "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("bs")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("1M "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("count")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2048")]),t._v("\n")])])]),s("p",[t._v("其中 "),s("code",[t._v("bs")]),t._v("×"),s("code",[t._v("count")]),t._v(" 为 SWAP 分区大小，这个示例中大小位 2G. "),s("code",[t._v("bs")]),t._v("为每块大小，"),s("code",[t._v("count")]),t._v("为块数。"),s("br"),t._v(" "),s("code",[t._v("/swapfile")]),t._v("为生成的分区路径。")])]),t._v(" "),s("li",[s("p",[t._v("将刚才生成的分区设置为 SWAP 分区")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkswap")]),t._v(" /swapfile\n")])])])]),t._v(" "),s("li",[s("p",[t._v("启用 SWAP 分区")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("swapon")]),t._v(" /swapfile\n")])])])]),t._v(" "),s("li",[s("p",[t._v("自动挂载分区")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("vim")]),t._v(" /etc/fstab\n")])])]),s("p",[t._v("添加行并保存：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("/swapfile swap swap defaults "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n")])])])]),t._v(" "),s("li",[s("p",[t._v("检查 swappiness 值"),s("br"),t._v("\n这个参数控制操作系统使用 SWAP 分区的时机。参数范围由 0 到 100。当参数为 0 时表示系统最大程度使用物理内存，耗尽时使用 SWAP 分区；100 表示积极使用 SWAP 分区，将物理内存上的内容及时搬运到 SWAP 分区里。CentOS 7 默认为 30；CentOS 6 默认为 60."),s("br"),t._v("\n使用命令检查：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("cat")]),t._v(" /proc/sys/vm/swappiness\n")])])]),s("p",[t._v("若需修改，执行命令：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 临时修改")]),t._v("\nsysctl vm.swappiness"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("?\n")])])]),s("p",[t._v("或者")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 永久修改")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("vim")]),t._v(" /etc/sysctl.conf\n")])])]),s("p",[t._v("并添加行：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("vm.swappiness"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("?\n")])])])]),t._v(" "),s("li",[s("p",[t._v("查看内存情况"),s("br"),t._v("\n使用命令：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("free")]),t._v("\n")])])])])])])]),t._v(" "),s("h2",{attrs:{id:"step-3-安装并配置-jdk"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#step-3-安装并配置-jdk"}},[t._v("#")]),t._v(" Step 3. 安装并配置 JDK")]),t._v(" "),s("ol",[s("li",[t._v("在 "),s("a",{attrs:{href:"http://jdk.java.net/",target:"_blank",rel:"noopener noreferrer"}},[t._v("OpenJDK"),s("OutboundLink")],1),t._v("下载 Linux 适用的 JDK 压缩包，并使用 FileZilla 上传到服务器合适的位置。")]),t._v(" "),s("li",[t._v("解压缩"),s("br"),t._v("\n使用命令："),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("tar")]),t._v(" -xzvf openjdk-****_linux-x64_bin.tar.gz\n")])])]),t._v("*"),s("em",[t._v("将命令中的文件替换成你所下载的版本。")])]),t._v(" "),s("li",[t._v("配置环境变量"),s("br"),t._v("\n这里使用对系统所有用户有效且便于维护的方法进行设置。这个操作需要管理员权限。使用命令：\n"),s("ol",[s("li",[s("p",[t._v("新建 Shell 脚本并编辑")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("vim")]),t._v(" /etc/profile.d/java.sh\n")])])]),s("p",[t._v("编辑内容并保存：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Java Environment")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("JAVA_HOME")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/root/java/jdk-11\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("PATH")])]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("$PATH")]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$JAVA_HOME")]),t._v("/bin\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("CLASSPATH")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$JAVA_HOME")]),t._v("/lib\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" JAVA_HOME "),s("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("PATH")]),t._v(" CLASSPATH\n")])])]),s("p",[t._v("*"),s("em",[t._v("将命令中 "),s("code",[t._v("JAVA_HOME")]),t._v(" 替换成刚才解压完成后生成的文件夹路径。")]),s("br"),t._v("\n这样的配置方式可以在不需要该环境变量时更简便地进行维护。")])]),t._v(" "),s("li",[s("p",[t._v("使环境变量生效"),s("br"),t._v("\n使用命令：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("source")]),t._v(" /etc/profile.d/java.sh\n")])])])]),t._v(" "),s("li",[s("p",[t._v("检查是否生效"),s("br"),t._v("\n使用命令：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("java -version\n")])])]),s("p",[t._v("若正确显示版本信息表明配置正确。")])])])])]),t._v(" "),s("h2",{attrs:{id:"step-4-设置防火墙"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#step-4-设置防火墙"}},[t._v("#")]),t._v(" Step 4. 设置防火墙")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("检查防火墙状态"),s("br"),t._v("\n默认情况下，CentOS 7 已经内置并开启了防火墙 firewalld. 使用命令检查其状态：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("firewall-cmd --state\n")])])]),s("p",[t._v("若显示 "),s("code",[t._v("running")]),t._v(" 则已开启。")]),t._v(" "),s("p",[t._v("当显示命令不存在时，使用命令安装：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("yum "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" firewalld -y\n")])])])]),t._v(" "),s("li",[s("p",[t._v("设置放行规则"),s("br"),t._v("\n使用命令：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("firewall-cmd --permanent --zone"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("public --add-port"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v("/tcp\nfirewall-cmd --permanent --zone"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("public --add-port"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v("/tcp\nfirewall-cmd --permanent --zone"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("public --add-port"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("443")]),t._v("/tcp\nfirewall-cmd --permanent --zone"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("public --add-port"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3306")]),t._v("/tcp\nfirewall-cmd --permanent --zone"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("public --add-port"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8080")]),t._v("/tcp\nfirewall-cmd --permanent --zone"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("public --add-port"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8081")]),t._v("/tcp\nfirewall-cmd --permanent --zone"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("public --add-port"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8082")]),t._v("/tcp\n")])])]),s("p",[t._v("每一条都显示"),s("code",[t._v("success")]),t._v("则正确。")])]),t._v(" "),s("li",[s("p",[t._v("重载防火墙以使得配置生效"),s("br"),t._v("\n使用命令：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("firewall-cmd --reload\n")])])])]),t._v(" "),s("li",[s("p",[t._v("检查防火墙"),s("br"),t._v("\n使用命令：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("firewall-cmd --zone"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("public --list-ports\n")])])]),s("p",[t._v("检查所有要设置的端口都已放行。")])])]),t._v(" "),s("h2",{attrs:{id:"step-5-安装-mysql"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#step-5-安装-mysql"}},[t._v("#")]),t._v(" Step 5. 安装 MySQL")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("下载 yum repository"),s("br"),t._v("\n访问 "),s("a",{attrs:{href:"https://dev.mysql.com/downloads/repo/yum/",target:"_blank",rel:"noopener noreferrer"}},[t._v("MySQL Community Downloads"),s("OutboundLink")],1),t._v("，找到适合的版本，点击"),s("code",[t._v("Download")]),t._v("。在页面中，复制"),s("code",[t._v("No thanks, just start my download.")]),t._v("链接所对应的地址。"),s("br"),t._v("\n在服务器端使用命令下载 rpm 文件：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("wget")]),t._v(" https://dev.mysql.com/get/platform-and-version-specific-package-name.noarch.rpm\n")])])]),s("p",[t._v("*"),s("em",[t._v("命令中 url 替换为刚才复制的链接。")])])]),t._v(" "),s("li",[s("p",[t._v("安装 yum repository"),s("br"),t._v("\n使用命令安装：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("yum -y "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" platform-and-version-specific-package-name.noarch.rpm\n")])])])]),t._v(" "),s("li",[s("p",[t._v("安装 MySQL"),s("br"),t._v("\n使用命令：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("yum "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" mysql-community-server\n")])])]),s("p",[t._v("按提示键入 "),s("code",[t._v("y")]),t._v(" 来确认。")])]),t._v(" "),s("li",[s("p",[t._v("启动 MySQL"),s("br"),t._v("\n使用命令来启动 MySQL 服务：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("systemctl start mysqld.service\n")])])]),s("p",[t._v("接着使用命令来查看 MySQL 服务的状态：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("systemctl status mysqld.service\n")])])]),s("p",[t._v("若显示绿色的 "),s("code",[t._v("active (running)")]),t._v(" 则 MySQL 启动正常。")])]),t._v(" "),s("li",[s("p",[t._v("登录并配置 MySQL"),s("br"),t._v("\n输入命令获得 MySQL 自动生成的初始密码：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'temporary password'")]),t._v(" /var/log/mysqld.log\n")])])]),s("p",[t._v("*"),s("em",[t._v("返回的 "),s("code",[t._v("2020-08-23T13:59:15.793152Z 6 [Note] [MY-010454] [Server] A temporary password is generated for root@localhost: ********")]),t._v(" 末尾为初始密码")])]),t._v(" "),s("p",[t._v("复制初试密码并登录 MySQL：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("mysql -uroot -p\n")])])]),s("p",[t._v("按提示粘贴密码并确定。")]),t._v(" "),s("p",[t._v("使用命令更改自定义 MySQL 登录密码：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("ALTER "),s("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("USER")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'root'")]),t._v("@"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'localhost'")]),t._v(" IDENTIFIED BY "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'MyNewPass4!'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("*"),s("em",[t._v("注意这里是 SQL 语句，需以分号结尾。")])]),t._v(" "),s("p",[t._v("使用命令来更改远程连接：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("CREATE "),s("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("USER")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'root'")]),t._v("@"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'%'")]),t._v(" IDENTIFIED BY "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'******'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("这里 "),s("code",[t._v("%")]),t._v(" 指所有 IP，根据需要可以改为固定某 IP。"),s("code",[t._v("******")]),t._v(" 为对应密码。")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("GRANT ALL PRIVILEGES ON *.* TO "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'root'")]),t._v("@"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'%'")]),t._v(" WITH GRANT OPTION"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("设置新创建的账户的权限。")])]),t._v(" "),s("li",[s("p",[t._v("按需求建立数据库、执行数据库文件")])])]),t._v(" "),s("h2",{attrs:{id:"step-6-安装-tomcat"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#step-6-安装-tomcat"}},[t._v("#")]),t._v(" Step 6. 安装 Tomcat")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("下载 Tomcat"),s("br"),t._v("\n访问 "),s("a",{attrs:{href:"https://tomcat.apache.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Apache Tomcat"),s("OutboundLink")],1),t._v(", 选择合适的版本并下载。")])]),t._v(" "),s("li",[s("p",[t._v("安装 Tomcat"),s("br"),t._v("\n将下载好的文件使用 FileZilla 上传到服务器，按类似安装 JDK 的方法在合适的位置解压缩。按需要可以解压多份 Tomcat 服务器以后备用。")])])]),t._v(" "),s("h2",{attrs:{id:"step-7-安装并配置-tengine"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#step-7-安装并配置-tengine"}},[t._v("#")]),t._v(" Step 7. 安装并配置 Tengine")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("下载并安装相关软件"),s("br"),t._v("\n使用命令安装编译器：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("yum -y "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" gcc gcc-c++ autoconf automake "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v("\n")])])]),s("p",[t._v("使用命令安装 pcre-devel：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("yum -y "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" pcre-devel\n")])])]),s("p",[t._v("使用命令安装 OpenSSL：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("yum -y "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" openssl openssl-devel\n")])])])]),t._v(" "),s("li",[s("p",[t._v("下载并安装 Tengine"),s("br"),t._v("\n访问"),s("a",{attrs:{href:"http://tengine.taobao.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("The Tengine Web Server"),s("OutboundLink")],1),t._v("下载压缩包，并使用 FileZilla 上传到服务器适当的位置。按类似安装 JDK 的方法解压缩。")]),t._v(" "),s("p",[t._v("在服务器访问解压好的文件夹，使用命令：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("./configure\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v("\n")])])]),s("p",[t._v("*"),s("em",[t._v("请确保安装过程没有报错：类似"),s("code",[t._v("./configure: error")]),t._v("的错误提示。若有，请查阅相关文档解决。")]),s("br"),t._v("\n*"),s("em",[t._v("Tengine 默认将安装在 "),s("code",[t._v("/usr/local/nginx")]),t._v(" 目录。")])])]),t._v(" "),s("li",[s("p",[t._v("配置环境变量"),s("br"),t._v("\n使用命令生成并保存文件：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("vim")]),t._v(" /etc/profile.d/tengine.sh\n")])])]),s("p",[t._v("编辑内容：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Tengine Environment")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("PATH")])]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("$PATH")]),t._v(":/usr/local/nginx/sbin\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("PATH")]),t._v("\n")])])]),s("p",[t._v("使环境变量生效  使用命令：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("source")]),t._v(" /etc/profile.d/tengine.sh\n")])])]),s("p",[t._v("检查是否生效"),s("br"),t._v("\n使用命令：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("nginx -v\n")])])]),s("p",[t._v("若正确显示版本信息表明配置正确。")])]),t._v(" "),s("li",[s("p",[t._v("设置为系统服务"),s("br"),t._v("\n使用命令创建文件，使得 Tengine 开机自启：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("vim")]),t._v(" /lib/systemd/system/nginx.service\n")])])]),s("p",[t._v("编辑内容并保存：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Unit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("Description")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("The nginx HTTP and reverse proxy server\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("After")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("syslog.target network.target remote-fs.target nss-lookup.target\n \n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Service"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("Type")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("forking\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("PIDFile")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/usr/local/nginx/logs/nginx.pid\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("ExecStartPre")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/usr/local/nginx/sbin/nginx -t\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("ExecStart")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/usr/local/nginx/sbin/nginx -c /usr/local/nginx/conf/nginx.conf\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("ExecReload")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/bin/kill -s HUP "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$MAINPID")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("ExecStop")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/bin/kill -s QUIT "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$MAINPID")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("PrivateTmp")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("true\n \n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Install"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("WantedBy")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("multi-user.target\n")])])]),s("p",[t._v("修改该文件权限：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("chmod")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("745")]),t._v(" /lib/systemd/system/nginx.service\n")])])]),s("p",[t._v("设置开机自启：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("systemctl "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("enable")]),t._v(" nginx.service\n")])])])])]),t._v(" "),s("h2",{attrs:{id:"step-8-部署并测试项目"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#step-8-部署并测试项目"}},[t._v("#")]),t._v(" Step 8. 部署并测试项目")]),t._v(" "),s("p",[t._v("下面再对 Tomcat 和 Tengine 进行一些操作和配置，最后进行简单地测试确保项目已经正确运行。")]),t._v(" "),s("h3",{attrs:{id:"上传项目包"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#上传项目包"}},[t._v("#")]),t._v(" 上传项目包")]),t._v(" "),s("p",[t._v("在本地测试完成后，使用 FileZilla 将 "),s("code",[t._v(".war")]),t._v(" 压缩包上传到服务器端。上传路径为 "),s("code",[t._v("apache-tomcat-****/webapps")]),s("br"),t._v("\n若你有多个项目需要分别上传到每个 Tomcat 中。在这篇文章的示例里，会将三个项目分别上传到三份 Tomcat 中。")]),t._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),s("p",[t._v("当在 IDE 测试导出项目时，请：")]),t._v(" "),s("ul",[s("li",[t._v("明确项目配置文件中 MySQL 密码已经与服务器中安装的 MySQL 密码相同。")]),t._v(" "),s("li",[t._v("明确配置文件中当前项目的端口号以便后续配置。在这篇文章的示例里三个项目的端口号分别为 "),s("code",[t._v("8080")]),t._v(", "),s("code",[t._v("8081")]),t._v(" 和 "),s("code",[t._v("8082")]),t._v(".")])])]),t._v(" "),s("p",[t._v("上传完毕后对文件夹中的部分文件做些修改，以使我们的项目成为该 Tomcat 的默认项目。")]),t._v(" "),s("ul",[s("li",[t._v("重命名 "),s("code",[t._v("ROOT")]),t._v(" 文件夹，添加后缀类似 "),s("code",[t._v("_1")]),t._v(" 以使自动生成的 ROOT 项目不再是默认项目。")]),t._v(" "),s("li",[t._v("重命名我们上传的项目为 "),s("code",[t._v("ROOT.war")]),t._v(". 当服务器启动时会自动解压该包来生成默认项目文件夹 ROOT.")])]),t._v(" "),s("p",[t._v("完成后："),s("br"),t._v(" "),s("img",{attrs:{src:"/img/tomcat_webapps.jpg",alt:"Tomcat Webapps"}})]),t._v(" "),s("h3",{attrs:{id:"配置-tomcat"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置-tomcat"}},[t._v("#")]),t._v(" 配置 Tomcat")]),t._v(" "),s("p",[t._v("我们对每一个 Tomcat 的配置文件进行修改。"),s("br"),t._v("\n访问文件夹："),s("code",[t._v("apache-tomcat-******/conf/")]),t._v("，找到"),s("code",[t._v("server.xml")]),t._v("进行编辑：")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("将每个 Tomcat 的 "),s("code",[t._v("port")]),t._v(" 设置项改为与所开发的 Web APP 设置一致。把 "),s("code",[t._v("redirectPort")]),t._v(" 设置项改为 "),s("code",[t._v("443")]),t._v(". 保存修改。")]),t._v(" "),s("div",{staticClass:"language-xml extra-class"},[s("div",{staticClass:"highlight-lines"},[s("div",{staticClass:"highlighted"},[t._v(" ")]),s("br"),s("div",{staticClass:"highlighted"},[t._v(" ")]),s("br")]),s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("Connector")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("port")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("8080"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("protocol")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("HTTP/1.1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("connectionTimeout")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("20000"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("redirectPort")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("443"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n")])])]),s("p",[t._v("之后类似的，将 SHUTDOWN 用的 "),s("code",[t._v("8085")]),t._v(" 依次改为不同的端口，保存修改。")])]),t._v(" "),s("li",[s("p",[t._v("在每个 Tomcat 的 "),s("code",[t._v("server.xml")]),t._v(" 配置文件中增添标签："),s("br"),t._v("\n找到 "),s("code",[t._v("<Engine>...</Engine>")]),t._v(" 标签，在其中添加子标签用以后续配合 Tengine 识别 HTTP 和 HTTPS 访问：")]),t._v(" "),s("div",{staticClass:"language-xml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("Engine")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("Catalina"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("defaultHost")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("localhost"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("Valve")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("className")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("org.apache.catalina.valves.RemoteIpValve"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("remoteIpHeader")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("X-Forwarded-For"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("protocolHeader")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("X-Forwarded-Proto"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("protocolHeaderHttpsValue")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("https"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n...\n")])])]),s("p",[t._v("完成后保存修改。")])])]),t._v(" "),s("h3",{attrs:{id:"再配置-tengine"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#再配置-tengine"}},[t._v("#")]),t._v(" 再配置 Tengine")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("创建 HTTPS 证书文件夹并上传证书"),s("br"),t._v("\n在目录 "),s("code",[t._v("/usr/local/nginx/conf/")]),t._v(" 下创建 "),s("code",[t._v("cert/")]),t._v(" 文件夹。访问域名提供商（如阿里云）控制台下载 HTTPS 证书。下载完成后通过 FileZilla 上传到刚才建立的文件夹中。")])]),t._v(" "),s("li",[s("p",[t._v("配置 Tengine"),s("br"),t._v("\n使用命令编辑 Tengine 的配置文件以设置服务器反向代理：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("vim")]),t._v(" /usr/local/nginx/conf/nginx.conf\n")])])]),s("div",{staticClass:"language-properties extra-class"},[s("div",{staticClass:"highlight-lines"},[s("div",{staticClass:"highlighted"},[t._v(" ")]),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("div",{staticClass:"highlighted"},[t._v(" ")]),s("div",{staticClass:"highlighted"},[t._v(" ")]),s("div",{staticClass:"highlighted"},[t._v(" ")]),s("br"),s("div",{staticClass:"highlighted"},[t._v(" ")]),s("br"),s("br"),s("div",{staticClass:"highlighted"},[t._v(" ")]),s("br"),s("div",{staticClass:"highlighted"},[t._v(" ")]),s("div",{staticClass:"highlighted"},[t._v(" ")]),s("br"),s("br"),s("br"),s("br"),s("div",{staticClass:"highlighted"},[t._v(" ")]),s("div",{staticClass:"highlighted"},[t._v(" ")]),s("br"),s("br"),s("div",{staticClass:"highlighted"},[t._v(" ")]),s("br"),s("br"),s("br"),s("div",{staticClass:"highlighted"},[t._v(" ")]),s("div",{staticClass:"highlighted"},[t._v(" ")]),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br")]),s("pre",{pre:!0,attrs:{class:"language-properties"}},[s("code",[s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("pid")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("       /usr/local/nginx/logs/nginx.pid; # 去掉该行注释，更改该项内容为此。")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("http")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("{")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("    include")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("      mime.types;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("    default_type")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v(" application/octet-stream;")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("    sendfile")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("       on;")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("    keepalive_timeout")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v(" 65;")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("    upstream")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("tomcat*** {")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("        server")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("localhost:8080; # 对应 Tomcat 服务器中配置文件中的设置")]),t._v("\n    }\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("    # HTTPS server")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("    server")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("{")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("        listen")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("      443 ssl;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("        server_name")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v(" domain.com; # 改为在域名商购买的域名")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("        ssl_certificate")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("     cert/domain_name.pem; # 改为刚才保存在 cer/ 文件夹中 .pem 文件路径")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("        ssl_certificate_key")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v(" cert/domain_name.key; # 改为刚才保存在 cer/ 文件夹中 .key 文件路径")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("        ssl_session_cache")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("   shared:SSL:1m;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("        ssl_session_timeout")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v(" 5m;")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("        ssl_ciphers")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4; #使用此加密套件。")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("        ssl_protocols")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("TLSv1 TLSv1.1 TLSv1.2; #使用该协议进行配置。")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("        ssl_prefer_server_ciphers")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v(" on;")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("        rewrite")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("^(.*)$ https://$host$1 permanent;   #将所有 HTTP 请求通过 rewrite 重定向到 HTTPS。")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("        location")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("/ {")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("            root")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("  html;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("            index")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v(" index.html index.htm; # 改为 Web APP 开发设置的首页")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("            proxy_pass")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("http://tomcat_***; # 对应上面 upstream 项进行修改")]),t._v("\n        }\n    }\n    \n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("    server")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("{ # 对应 HTTP 访问进行跳转")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("        lisent")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("80;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("        server_name")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("health.ahza.xin;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("        return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("301 https://******$request_uri; # 跳转 URL设置为 HTTPS协议")]),t._v("\n    }\n}\n")])])]),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),s("p",[s("code",[t._v("upstream")]),t._v(" 项命名不能使用下划线，否则 Tomcat 报 400 错误。")])]),t._v(" "),s("p",[t._v("有几个 Tomcat 就配置几对 "),s("code",[t._v("upstream")]),t._v(" 和 "),s("code",[t._v("server")]),t._v(". 下面是本篇文章中的配置文件示例：")]),t._v(" "),s("div",{staticClass:"language-properties extra-class"},[s("pre",{pre:!0,attrs:{class:"language-properties"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v(" #user  nobody;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v(" worker_processes")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v(" 1;")]),t._v("\n \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v(" #error_log  logs/error.log;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v(" #error_log  logs/error.log  notice;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v(" #error_log  logs/error.log  info;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v(' #error_log  "pipe:rollback logs/error_log interval=1d baknum=7 maxsize=2G";')]),t._v("\n \n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v(" pid")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("       /usr/local/nginx/logs/nginx.pid;")]),t._v("\n \n \n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v(" events")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("{")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("     worker_connections")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v(" 1024;")]),t._v("\n }\n \n \n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v(" http")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("{")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("     include")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("      mime.types;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("     default_type")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v(" application/octet-stream;")]),t._v("\n \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("     #log_format  main  '$remote_addr - $remote_user [$time_local] \"$request\" '")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("     #                  '$status $body_bytes_sent \"$http_referer\" '")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('     #                  \'"$http_user_agent" "$http_x_forwarded_for"\';')]),t._v("\n \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("     #access_log  logs/access.log  main;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('     #access_log  "pipe:rollback logs/access_log interval=1d baknum=7 maxsize=2G"  main;')]),t._v("\n \n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("     sendfile")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("       on;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("     #tcp_nopush     on;")]),t._v("\n \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("     #keepalive_timeout  0;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("     keepalive_timeout")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v(" 65;")]),t._v("\n \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("     #gzip  on;")]),t._v("\n \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("     #server {")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("     #    listen       80;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("     #    server_name  localhost;")]),t._v("\n \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("         #charset koi8-r;")]),t._v("\n \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("         #access_log  logs/host.access.log  main;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('         #access_log  "pipe:rollback logs/host.access_log interval=1d baknum=7 maxsize=2G"  main;')]),t._v("\n \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("     #    location / {")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("     #        root   html;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("     #        index  index.html index.htm;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("     #    }")]),t._v("\n \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("         #error_page  404              /404.html;")]),t._v("\n \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("         # redirect server error pages to the static page /50x.html")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("         #")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("         # error_page   500 502 503 504  /50x.html;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("         # location = /50x.html {")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("         #     root   html;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("         # }")]),t._v("\n \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("         # proxy the PHP scripts to Apache listening on 127.0.0.1:80")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("         #")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("         #location ~ \\.php$ {")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("         #    proxy_pass   http://127.0.0.1;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("         #}")]),t._v("\n \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("         # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("         #")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("         #location ~ \\.php$ {")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("         #    root           html;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("         #    fastcgi_pass   127.0.0.1:9000;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("         #    fastcgi_index  index.php;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("         #    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("         #    include        fastcgi_params;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("         #}")]),t._v("\n \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("         # pass the Dubbo rpc to Dubbo provider server listening on 127.0.0.1:20880")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("         #")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("         #location /dubbo {")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("         #    dubbo_pass_all_headers on;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("         #    dubbo_pass_set args $args;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("         #    dubbo_pass_set uri $uri;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("         #    dubbo_pass_set method $request_method;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("         #")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("         #    dubbo_pass org.apache.dubbo.samples.tengine.DemoService 0.0.0 tengineDubbo dubbo_backend;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("         #}")]),t._v("\n \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("         # deny access to .htaccess files, if Apache's document root")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("         # concurs with nginx's one")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("         #")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("         #location ~ /\\.ht {")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("         #    deny  all;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("         #}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("     # }")]),t._v("\n \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("     # upstream for Dubbo rpc to Dubbo provider server listening on 127.0.0.1:20880")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("     #")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("     #upstream dubbo_backend {")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("     #    multi 1;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("     #    server 127.0.0.1:20880;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("     #}")]),t._v("\n \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("     # another virtual host using mix of IP-, name-, and port-based configuration")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("     #")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("     #server {")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("     #    listen       8000;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("     #    listen       somename:8080;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("     #    server_name  somename  alias  another.alias;")]),t._v("\n \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("     #    location / {")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("     #        root   html;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("     #        index  index.html index.htm;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("     #    }")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("     #}")]),t._v("\n \n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("     upstream")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("tomcatHealth {")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("         server")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("localhost:8080;")]),t._v("\n     }\n \n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("     upstream")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("tomcatOjFront {")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("         server")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("localhost:8081;")]),t._v("\n     }\n \n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("     upstream")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("tomcatOjBack {")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("         server")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("localhost:8082;")]),t._v("\n     }\n \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("     # HTTPS server 1")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("     server")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("{")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("         listen")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("      443 ssl;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("         server_name")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v(" health.ahza.xin;")]),t._v("\n \n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("         ssl_certificate")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("     cert/3030836_health.ahza.xin.pem;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("         ssl_certificate_key")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v(" cert/3030836_health.ahza.xin.key;")]),t._v("\n \n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("         ssl_session_cache")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("   shared:SSL:1m;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("         ssl_session_timeout")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v(" 5m;")]),t._v("\n \n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("         ssl_ciphers")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("         ssl_protocols")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("TLSv1 TLSv1.1 TLSv1.2;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("         ssl_prefer_server_ciphers")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v(" on;")]),t._v("\n \n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("         location")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("/ {")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("             root")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("  html;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("             index")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v(" index.html index.htm;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("             proxy_pass")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("http://tomcatHealth;")]),t._v("\n         }\n     }\n \n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("     server")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("{")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("         listen")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("80;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("         server_name")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("health.ahza.xin;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("         return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("301 https://health.ahza.xin$request_uri;")]),t._v("\n     }\n \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("     # HTTPS server 2")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("     server")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("{")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("         listen")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("      443 ssl;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("         server_name")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v(" oj.front.ahza.xin;")]),t._v("\n \n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("         ssl_certificate")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("     cert/3030823_oj.front.ahza.xin.pem;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("         ssl_certificate_key")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v(" cert/3030823_oj.front.ahza.xin.key;")]),t._v("\n \n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("         ssl_session_cache")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("   shared:SSL:1m;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("         ssl_session_timeout")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v(" 5m;")]),t._v("\n \n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("         ssl_ciphers")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("         ssl_protocols")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("TLSv1 TLSv1.1 TLSv1.2;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("         ssl_prefer_server_ciphers")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v(" on;")]),t._v("\n \n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("         location")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("/ {")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("             root")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("  html;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("             index")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v(" login.html index.html index.htm;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("             proxy_pass")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("http://tomcatOjFront;")]),t._v("\n         }\n     }\n \n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("     server")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("{")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("         listen")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("80;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("         server_name")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("oj.front.ahza.xin;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("         return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("301 https://oj.front.ahza.xin$request_uri;")]),t._v("\n     }\n \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("     # HTTPS server 3")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("     server")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("{")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("         listen")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("      443 ssl;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("         server_name")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v(" oj.back.ahza.xin;")]),t._v("\n \n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("         ssl_certificate")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("     cert/3030837_oj.back.ahza.xin.pem;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("         ssl_certificate_key")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v(" cert/3030837_oj.back.ahza.xin.key;")]),t._v("\n \n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("         ssl_session_cache")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("   shared:SSL:1m;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("         ssl_session_timeout")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v(" 5m;")]),t._v("\n \n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("         ssl_ciphers")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("         ssl_protocols")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("TLSv1 TLSv1.1 TLSv1.2;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("         ssl_prefer_server_ciphers")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v(" on;")]),t._v("\n \n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("         location")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("/ {")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("             root")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("  html;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("             index")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v(" login.html index.html index.htm;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("             proxy_pass")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("http://tomcatOjBack;")]),t._v("\n         }\n     }\n \n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("     server")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("{")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("         listen")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("80;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("         server_name")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("oj.back.ahza.xin;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("         return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("301 https://oj.back.ahza.xin$request_uri;")]),t._v("\n     }\n \n }\n")])])]),s("p",[t._v("使用命令测试配置是否正确：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("nginx -t\n")])])]),s("p",[t._v("如提示错误查阅相关文档解决。")]),t._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),s("p",[t._v("这里配置的所有域名均需要经过 ICP 域名信息备案，否则可能会被服务器提供商禁止访问。")])])])]),t._v(" "),s("h3",{attrs:{id:"启动项目以测试"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#启动项目以测试"}},[t._v("#")]),t._v(" 启动项目以测试")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("启动 Tengine"),s("br"),t._v("\n使用命令：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("systemctl start nginx.service\n")])])])]),t._v(" "),s("li",[s("p",[t._v("启动 Tomcat"),s("br"),t._v("\n分别进入每一个 Tomcat 文件夹中，访问 "),s("code",[t._v("bin/")]),t._v(" 文件夹，并使用命令启动 Tomcat：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("./startup.sh\n")])])]),s("p",[t._v("访问 "),s("code",[t._v("logs/")]),t._v(" 文件夹，使用命令观察启动情况：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("tail")]),t._v(" -f catalina.out \n")])])]),s("p",[t._v("出现问题时，请查阅相关文档解决。")])])]),t._v(" "),s("h2",{attrs:{id:"你可能会遇到的问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#你可能会遇到的问题"}},[t._v("#")]),t._v(" 你可能会遇到的问题")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("Q：项目正常运行几天后再访问报 502 Bad Gateway 错误怎么办？"),s("br"),t._v("\nA：明确报错项目，命令访问到它所在的 Tomcat 并尝试重新启动它。")])]),t._v(" "),s("li",[s("p",[t._v("Q：为什么本地端 IDE 测试项目可以正确运行，服务器启动 Tomcat 后报错。错误内容以 "),s("code",[t._v("Error creating bean with name 'entityManagerFactory' defined in class path resource [org/springframework/boot/autoconfigure/orm/jpa/HibernateJpaConfiguration.class]...")]),t._v(" 起头，包括 "),s("code",[t._v("Caused by: java.lang.NullPointerException: null")]),t._v(" ？"),s("br"),t._v("\nA：低版本的 javassist 库引起了这个问题，尝试修改 pom 文件以更新依赖来解决。如：")]),t._v(" "),s("div",{staticClass:"language-xml extra-class"},[s("div",{staticClass:"highlight-lines"},[s("br"),s("br"),s("br"),s("div",{staticClass:"highlighted"},[t._v(" ")]),s("br"),s("br"),s("br")]),s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("parent")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("org.springframework.boot"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("spring-boot-starter-parent"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("2.1.0.RELEASE"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("relativePath")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- lookup parent from repository --\x3e")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("parent")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])])])]),t._v(" "),s("h2",{attrs:{id:"参考文献或资料"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#参考文献或资料"}},[t._v("#")]),t._v(" 参考文献或资料")]),t._v(" "),s("p",[t._v("[1] vim. "),s("a",{attrs:{href:"https://github.com/vim/vim",target:"_blank",rel:"noopener noreferrer"}},[t._v("GitHub - vim/vim: The official Vim repository"),s("OutboundLink")],1),s("br"),t._v("\n[2] Vultr. "),s("a",{attrs:{href:"https://www.vultr.com/docs/how-do-i-generate-ssh-keys",target:"_blank",rel:"noopener noreferrer"}},[t._v("How Do I Generate SSH Keys?"),s("OutboundLink")],1),s("br"),t._v("\n[3] Vultr. "),s("a",{attrs:{href:"https://www.vultr.com/docs/deploy-a-new-server-with-an-ssh-key",target:"_blank",rel:"noopener noreferrer"}},[t._v("Deploy a New Server with an SSH Key"),s("OutboundLink")],1),s("br"),t._v("\n[4] Vultr. "),s("a",{attrs:{href:"https://www.vultr.com/docs/how-to-add-and-delete-ssh-keys",target:"_blank",rel:"noopener noreferrer"}},[t._v("How to Add and Delete SSH Keys"),s("OutboundLink")],1),s("br"),t._v("\n[5] 阿里云. "),s("a",{attrs:{href:"https://help.aliyun.com/document_detail/51793.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("创建SSH密钥对"),s("OutboundLink")],1),s("br"),t._v("\n[6] 阿里云. "),s("a",{attrs:{href:"https://help.aliyun.com/document_detail/51796.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("绑定SSH密钥对"),s("OutboundLink")],1),s("br"),t._v("\n[7] 阿里云. "),s("a",{attrs:{href:"https://help.aliyun.com/document_detail/51798.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("使用SSH密钥对连接Linux实例"),s("OutboundLink")],1),s("br"),t._v("\n[8] 明济安. "),s("a",{attrs:{href:"https://www.cnblogs.com/mingjian/p/5230387.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("linux设置虚拟内存（swap）解决mysql因内存不足挂掉的故障"),s("OutboundLink")],1),s("br"),t._v("\n[9] 乾乾君子. "),s("a",{attrs:{href:"https://blog.csdn.net/sirchenhua/article/details/87861709",target:"_blank",rel:"noopener noreferrer"}},[t._v("Linux SWAP交换分区应该设置多大？"),s("OutboundLink")],1),s("br"),t._v("\n[10] 悠悠i. "),s("a",{attrs:{href:"https://www.cnblogs.com/youyoui/p/10680329.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Linux环境变量配置全攻略"),s("OutboundLink")],1),s("br"),t._v("\n[11] taodanc. "),s("a",{attrs:{href:"https://blog.csdn.net/duan9015/article/details/103332154",target:"_blank",rel:"noopener noreferrer"}},[t._v("Linux下配置JDK11环境变量"),s("OutboundLink")],1),s("br"),t._v("\n[12] 菩提尘. "),s("a",{attrs:{href:"https://www.cnblogs.com/kevin1990/p/8641315.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Linux 环境下/etc/profile和/etc/profile.d 的区别"),s("OutboundLink")],1),s("br"),t._v("\n[13] 老蒋. "),s("a",{attrs:{href:"https://www.itbulu.com/centos7-firewalld.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("CentOS7安装firewalld防火墙添加放行端口简单演示过程"),s("OutboundLink")],1),s("br"),t._v("\n[14] Oracle. "),s("a",{attrs:{href:"https://dev.mysql.com/doc/mysql-yum-repo-quick-guide/en/",target:"_blank",rel:"noopener noreferrer"}},[t._v("A Quick Guide to Using the MySQL Yum Repository"),s("OutboundLink")],1),s("br"),t._v("\n[15] 24只羊. "),s("a",{attrs:{href:"https://blog.csdn.net/qq_36582604/article/details/80526287",target:"_blank",rel:"noopener noreferrer"}},[t._v("CentOS7安装MySQL（完整版）"),s("OutboundLink")],1),s("br"),t._v("\n[16] 王晨_icat. "),s("a",{attrs:{href:"https://www.jianshu.com/p/79ae3a922954",target:"_blank",rel:"noopener noreferrer"}},[t._v("MySQL server version for the right syntax to use near 'identified by \"******\" with grant option' ..."),s("OutboundLink")],1),s("br"),t._v("\n[17] Alibaba Group. "),s("a",{attrs:{href:"http://tengine.taobao.org/document_cn/install_cn.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("简单例子-The Tengine Web Server"),s("OutboundLink")],1),s("br"),t._v("\n[18] 随风ˇ止步. "),s("a",{attrs:{href:"https://www.cnblogs.com/zhoudemo/p/9043585.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Tengine安装"),s("OutboundLink")],1),s("br"),t._v("\n[19] 阿里云. "),s("a",{attrs:{href:"https://help.aliyun.com/document_detail/98728.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("在Nginx或Tengine服务器上安装证书"),s("OutboundLink")],1),s("br"),t._v("\n[20] 亡朝歌. "),s("a",{attrs:{href:"https://blog.csdn.net/baidu_34861695/article/details/97787413",target:"_blank",rel:"noopener noreferrer"}},[t._v("【新手向】Nginx+Tomcat+SSL 实现多项目http和https混用"),s("OutboundLink")],1),s("br"),t._v("\n[21] ye976142425. "),s("a",{attrs:{href:"https://blog.csdn.net/ye976142425/article/details/81409310",target:"_blank",rel:"noopener noreferrer"}},[t._v("nginx代理俩个不相干的tomcat,并且俩配置https,亲测。"),s("OutboundLink")],1),s("br"),t._v("\n[22] IPI715718. "),s("a",{attrs:{href:"https://blog.csdn.net/IPI715718/article/details/83549506",target:"_blank",rel:"noopener noreferrer"}},[t._v('nginx 启动报错“var/run/nginx/nginx.pid" no such file or directory解决方法'),s("OutboundLink")],1),s("br"),t._v("\n[23] 温故而知新666. "),s("a",{attrs:{href:"https://blog.csdn.net/nimasike/article/details/51889171?utm_medium=distribute.pc_aggpage_search_result.none-task-blog-2~all~baidu_landing_v2~default-1-51889171.nonecase&utm_term=tengine%E5%8A%A0%E5%85%A5%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E5%BC%80%E6%9C%BA%E5%90%AF%E5%8A%A8",target:"_blank",rel:"noopener noreferrer"}},[t._v("CentOs7 安装Tengine 并设置成系统服务，开机自动启动。"),s("OutboundLink")],1),s("br"),t._v("\n[24] 西邮陈冠希. "),s("a",{attrs:{href:"https://blog.csdn.net/weixin_38214171/article/details/85333852",target:"_blank",rel:"noopener noreferrer"}},[t._v("nginx配置tomcat反向代理出现 java.lang.IllegalArgumentException: The character [_] is never valid in a domai"),s("OutboundLink")],1),s("br"),t._v("\n[25] Maxwell1987. "),s("a",{attrs:{href:"https://my.oschina.net/u/1762727/blog/2877884",target:"_blank",rel:"noopener noreferrer"}},[t._v("[每日短篇] 12 - Spring Boot + JPA 因为 javassist 包出现 NullPointerException 问题的解决"),s("OutboundLink")],1)])])}),[],!1,null,null,null);a.default=n.exports}}]);